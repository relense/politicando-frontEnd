{"ast":null,"code":"import _regeneratorRuntime from \"/Users/miguelfurtado/Documents/Projetos/politicando/policando-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/miguelfurtado/Documents/Projetos/politicando/policando-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nexport function post(_x, _x2) {\n  return _post.apply(this, arguments);\n}\n\nfunction _post() {\n  _post = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(url, payload) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", request(url, payload, \"POST\"));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n  return _post.apply(this, arguments);\n}\n\nexport function patch(_x3, _x4) {\n  return _patch.apply(this, arguments);\n}\n\nfunction _patch() {\n  _patch = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(url, payload) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", request(url, payload, \"PATCH\"));\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, this);\n  }));\n  return _patch.apply(this, arguments);\n}\n\nexport function get(_x5) {\n  return _get.apply(this, arguments);\n}\n\nfunction _get() {\n  _get = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(url) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", request(url, {}, \"GET\"));\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, this);\n  }));\n  return _get.apply(this, arguments);\n}\n\nfunction request(_x6, _x7, _x8) {\n  return _request.apply(this, arguments);\n}\n\nfunction _request() {\n  _request = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(url, payload, method) {\n    var response;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return doRequest(url, payload, method);\n\n          case 2:\n            response = _context4.sent;\n            return _context4.abrupt(\"return\", response);\n\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, this);\n  }));\n  return _request.apply(this, arguments);\n}\n\nfunction doRequest(_x9, _x10) {\n  return _doRequest.apply(this, arguments);\n}\n\nfunction _doRequest() {\n  _doRequest = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee5(url, payload) {\n    var method,\n        request,\n        responseStream,\n        resp,\n        _args5 = arguments;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            method = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : 'POST';\n            request = {\n              cache: 'no-cache',\n              method: method,\n              headers: {\n                'content-type': 'application/json',\n                'Access-Control-Allow-Methods': '*'\n              }\n            };\n            if (method !== 'GET') request.body = JSON.stringify(payload);\n            _context5.next = 5;\n            return fetch(url, request);\n\n          case 5:\n            responseStream = _context5.sent;\n\n            if (!(responseStream.status === 500)) {\n              _context5.next = 8;\n              break;\n            }\n\n            throw new Error({\n              errorCode: 'server_error'\n            });\n\n          case 8:\n            if (!(responseStream.status === 401)) {\n              _context5.next = 10;\n              break;\n            }\n\n            throw new Error({\n              responseStatus: 401,\n              errorCodes: 'Could not authenticate'\n            });\n\n          case 10:\n            if (!(responseStream.status === 204)) {\n              _context5.next = 12;\n              break;\n            }\n\n            return _context5.abrupt(\"return\", {});\n\n          case 12:\n            _context5.next = 14;\n            return responseStream.json();\n\n          case 14:\n            resp = _context5.sent;\n\n            if (!(resp.hasOwnProperty('data') || responseStream.status === 200)) {\n              _context5.next = 17;\n              break;\n            }\n\n            return _context5.abrupt(\"return\", resp);\n\n          case 17:\n            throw new Error({\n              responseStatus: responseStream.status,\n              errorCodes: resp.hasOwnProperty('errors') ? resp.errors : ['unknown']\n            });\n\n          case 18:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, this);\n  }));\n  return _doRequest.apply(this, arguments);\n}\n\nexport function buildJsonPayload(type, attributes) {\n  var id = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  var payload = {\n    data: {}\n  };\n  payload.data.type = type;\n  payload.data.attributes = attributes;\n  if (id) payload.data.id = id;\n  return payload;\n}","map":{"version":3,"sources":["/Users/miguelfurtado/Documents/Projetos/politicando/policando-frontend/src/api/Api.js"],"names":["post","url","payload","request","patch","get","method","doRequest","response","cache","headers","body","JSON","stringify","fetch","responseStream","status","Error","errorCode","responseStatus","errorCodes","json","resp","hasOwnProperty","errors","buildJsonPayload","type","attributes","id","data"],"mappings":"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","sourcesContent":["export async function post(url, payload) {\n    return request(url, payload, \"POST\")\n}\n\nexport async function patch(url, payload) {\n    return request(url, payload, \"PATCH\")\n}\n\nexport async function get(url) {\n    return request(url, {}, \"GET\")\n}\n\nasync function request(url, payload, method) {\n    const response = await doRequest(url, payload, method);\n    return response\n}\n\nasync function doRequest(url, payload, method = 'POST') {\n    const request = {\n        cache: 'no-cache',\n        method: method,\n        headers: {\n          'content-type': 'application/json',\n          'Access-Control-Allow-Methods': '*',\n        }\n    }\n\n    if (method !== 'GET') request.body = JSON.stringify(payload);\n\n    const responseStream = await fetch(url, request)\n\n    if (responseStream.status === 500) {\n        throw new Error ({\n          errorCode: 'server_error'\n         })\n    }\n\n    if (responseStream.status === 401) {\n        throw new Error({\n          responseStatus: 401,\n          errorCodes: 'Could not authenticate'\n        })\n    }\n\n    if (responseStream.status === 204) {\n        return { }\n    }\n\n    const resp = await responseStream.json()\n    if (resp.hasOwnProperty('data') || responseStream.status === 200) {\n        return resp\n    }\n\n    throw  new Error ({\n        responseStatus: responseStream.status,\n        errorCodes: resp.hasOwnProperty('errors') ? resp.errors :  ['unknown']\n    })\n}\n\nexport function buildJsonPayload (type, attributes, id=null) {\n    let payload = { data: {} };\n    payload.data.type = type;\n    payload.data.attributes = attributes;\n    if (id) payload.data.id = id;\n\n    return payload;\n}\n"]},"metadata":{},"sourceType":"module"}